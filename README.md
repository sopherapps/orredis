# orredis

Just a a simple fast ORM for python built in rust

## How to demo

```shell
python3 -m venv env 
source env/bin/activate
pip install -r requirements.txt
maturin develop
python
import orredis
# do stuff with orredis
```

## How to Test

```shell
python3 -m venv env 
source env/bin/activate
pip install -r requirements.txt
maturin develop
pytest
```

## Benchmarks

16th September 2022

### Bulk Inserts

#### pydantic-redis

```
------------------------------------------------------- benchmark: 1 tests -------------------------------------------------------
Name (time in ms)                              Min     Max    Mean  StdDev  Median     IQR  Outliers       OPS  Rounds  Iterations
----------------------------------------------------------------------------------------------------------------------------------
test_benchmark_bulk_insert[redis_store]     1.0353  1.4726  1.0766  0.0746  1.0478  0.0307       4;7  928.8924      59           1
----------------------------------------------------------------------------------------------------------------------------------
```

#### orredis

```
--------------------------------------------------------------- benchmark: 1 tests ---------------------------------------------------------------
Name (time in us)                                Min         Max      Mean   StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
--------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_bulk_insert[redis_store]     536.1690  1,159.2930  598.7722  38.0673  582.3160  34.8023     84;40        1.6701    1011           1
--------------------------------------------------------------------------------------------------------------------------------------------------
```

### Single Insert

#### pydantic-redis

```
------------------------------------------------------------------ benchmark: 1 tests ------------------------------------------------------------------
Name (time in us)                                        Min       Max      Mean   StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
--------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_single_insert[redis_store-book0]     394.7420  674.7820  443.2762  54.0996  429.4530  39.5740       7;7        2.2559      61           1
--------------------------------------------------------------------------------------------------------------------------------------------------------
```

#### orredis

``` 
------------------------------------------------------------------ benchmark: 1 tests ------------------------------------------------------------------
Name (time in us)                                        Min       Max      Mean   StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
--------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_single_insert[redis_store-book0]     220.2550  419.6770  252.7016  30.6270  242.4070  33.5625   227;124        3.9572    1680           1
--------------------------------------------------------------------------------------------------------------------------------------------------------
```

### Select All Items, All Columns

#### pydantic-redis

```
--------------------------------------------------------- benchmark: 1 tests --------------------------------------------------------
Name (time in ms)                                 Min     Max    Mean  StdDev  Median     IQR  Outliers       OPS  Rounds  Iterations
-------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_select_default[redis_store]     1.1369  2.1050  1.2322  0.0939  1.2001  0.0653     65;57  811.5888     536           1
-------------------------------------------------------------------------------------------------------------------------------------
```

#### orredis

```
--------------------------------------------------------- benchmark: 1 tests --------------------------------------------------------
Name (time in ms)                                 Min     Max    Mean  StdDev  Median     IQR  Outliers       OPS  Rounds  Iterations
-------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_select_default[redis_store]     1.6456  2.3329  1.7248  0.0539  1.7173  0.0358     58;21  579.7688     446           1
-------------------------------------------------------------------------------------------------------------------------------------
```

### Select All Items, Some Columns

#### pydantic-redis

```
----------------------------------------------------------------- benchmark: 1 tests ----------------------------------------------------------------
Name (time in us)                                   Min         Max      Mean   StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
-----------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_select_columns[redis_store]     829.1210  1,435.5640  936.6411  73.9743  910.0580  72.9880    142;34        1.0676     632           1
-----------------------------------------------------------------------------------------------------------------------------------------------------
```

#### orredis

```
--------------------------------------------------------- benchmark: 1 tests --------------------------------------------------------
Name (time in ms)                                 Min     Max    Mean  StdDev  Median     IQR  Outliers       OPS  Rounds  Iterations
-------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_select_columns[redis_store]     1.0876  2.5144  1.1648  0.0797  1.1593  0.0611     26;16  858.5479     587           1
-------------------------------------------------------------------------------------------------------------------------------------
```

### Select Some Items, All Columns

#### pydantic-redis

``` 
------------------------------------------------------------------ benchmark: 1 tests ------------------------------------------------------------------
Name (time in us)                                      Min         Max        Mean    StdDev    Median       IQR  Outliers       OPS  Rounds  Iterations
--------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_select_some_items[redis_store]     638.8910  9,931.9470  1,010.0479  990.6769  805.8675  170.2030    26;101  990.0520     786           1
--------------------------------------------------------------------------------------------------------------------------------------------------------
```

#### orredis

``` 
------------------------------------------------------------------ benchmark: 1 tests ------------------------------------------------------------------
Name (time in us)                                      Min         Max        Mean   StdDev      Median      IQR  Outliers       OPS  Rounds  Iterations
--------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_select_some_items[redis_store]     924.1230  1,333.6490  1,008.9675  47.1940  1,015.9670  55.4623    135;14  991.1122     615           1
--------------------------------------------------------------------------------------------------------------------------------------------------------
```

### Select Some Items, Some Columns

#### pydantic-redis

``` 
------------------------------------------------------------------------ benchmark: 1 tests ------------------------------------------------------------------------
Name (time in us)                                                  Min         Max      Mean   StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_select_columns_for_some_items[redis_store]     521.9080  1,051.5770  590.0739  52.2138  581.7810  30.0695   211;112        1.6947     876           1
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
```

#### orredis

``` 
------------------------------------------------------------------------ benchmark: 1 tests ------------------------------------------------------------------------
Name (time in us)                                                  Min         Max      Mean   StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_select_columns_for_some_items[redis_store]     629.2300  1,094.6230  673.8183  37.8365  659.0850  27.1202    108;77        1.4841     871           1
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
```

### Select Some Columns for One item

#### pydantic-redis

```
------------------------------------------------------------------------- benchmark: 1 tests -------------------------------------------------------------------------
Name (time in us)                                                    Min         Max      Mean   StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_select_columns_for_one_id[redis_store-book0]     432.0490  1,283.3870  478.5827  48.9717  462.1490  33.1770     62;51        2.0895    1018           1
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
```

#### orredis

```
------------------------------------------------------------------------ benchmark: 1 tests ------------------------------------------------------------------------
Name (time in us)                                                    Min       Max      Mean   StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_select_columns_for_one_id[redis_store-book0]     436.6400  863.9170  503.1452  42.9072  495.2645  59.3900    258;12        1.9875     970           1
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
```

### Select All Columns for One Item

#### pydantic-redis

``` 
----------------------------------------------------------------------- benchmark: 1 tests -----------------------------------------------------------------------
Name (time in us)                                                Min         Max      Mean   StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_select_all_for_one_id[redis_store-book0]     486.2540  1,159.9010  542.3541  48.7065  535.3745  31.9265     73;65        1.8438     884           1
------------------------------------------------------------------------------------------------------------------------------------------------------------------
```

#### orredis

``` 
----------------------------------------------------------------------- benchmark: 1 tests -----------------------------------------------------------------------
Name (time in us)                                                Min         Max      Mean   StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_select_all_for_one_id[redis_store-book0]     668.3060  1,081.5210  760.3733  45.6876  773.8600  54.4430    199;10        1.3151     747           1
------------------------------------------------------------------------------------------------------------------------------------------------------------------
```

### Update

#### pydantic-redis

``` 

------------------------------------------------------------------------ benchmark: 1 tests -----------------------------------------------------------------------
Name (time in us)                                                   Min       Max      Mean   StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_update[redis_store-Wuthering Heights-data0]     322.4000  962.5480  408.8422  88.3521  380.9710  97.1238     84;27        2.4459     643           1
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
```

#### orredis

``` 
------------------------------------------------------------------------ benchmark: 1 tests -----------------------------------------------------------------------
Name (time in us)                                                   Min       Max      Mean   StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_update[redis_store-Wuthering Heights-data0]     186.7170  393.6100  216.4799  25.0688  203.7240  19.4390   215;185        4.6194    1798           1
-------------------------------------------------------------------------------------------------------------------------------------------------------------------
```

### Delete One

#### pydantic-redis

```
----------------------------------------------------------------------- benchmark: 1 tests ----------------------------------------------------------------------
Name (time in us)                                             Min          Max      Mean    StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
-----------------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_delete[redis_store-Wuthering Heights]     151.3360  12,350.7080  452.2397  799.0145  259.6150  82.5930     42;88        2.2112     664           1
-----------------------------------------------------------------------------------------------------------------------------------------------------------------

```

#### orredis

```
--------------------------------------------------------------------- benchmark: 1 tests --------------------------------------------------------------------
Name (time in us)                                             Min       Max      Mean   StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
-------------------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_delete[redis_store-Wuthering Heights]     111.6590  281.1120  131.1303  16.6240  124.2750  14.7600   324;117        7.6260    2242           1
-------------------------------------------------------------------------------------------------------------------------------------------------------------
```

### Delete Bulk

#### pydantic-redis

```
---------------------------------------------------------------- benchmark: 1 tests ---------------------------------------------------------------
Name (time in us)                                Min         Max      Mean    StdDev    Median      IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
---------------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_bulk_delete[redis_store]     183.0900  6,198.5030  557.8025  976.7148  240.6170  85.4450     15;20        1.7927     147           1
--------------------------------------------------------------------------------------------------------------------------------------------------- 
```

#### orredis

``` 
-------------------------------------------------------------- benchmark: 1 tests -------------------------------------------------------------
Name (time in us)                                Min       Max      Mean   StdDev    Median     IQR  Outliers  OPS (Kops/s)  Rounds  Iterations
-----------------------------------------------------------------------------------------------------------------------------------------------
test_benchmark_bulk_delete[redis_store]     125.9090  292.5620  140.7581  16.2714  134.9630  2.6730   302;870        7.1044    2775           1
-----------------------------------------------------------------------------------------------------------------------------------------------
```

## How to test

- Clone the repo and enter its root folder

  ```bash
  git clone https://github.com/sopherapps/orredis.git && cd orredis
  ```

- Create a virtual environment and activate it

  ```bash
  virtualenv -p /usr/bin/python3.7 env && source env/bin/activate
  ```

- Install the dependencies

  ```bash
  pip install -r requirements.txt
  ```

- Install the package in the virtual environment

  ```bash
  maturin develop
  ```

- Run the tests command

  ```bash
  pytest --benchmark-disable
  ```

- Run benchmarks

  ```bash
  pytest --benchmark-compare --benchmark-autosave
  ```
